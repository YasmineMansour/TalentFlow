<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>

<VBox spacing="20" xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="org.example.GUI.UserWindowController"
      style="-fx-background-color: #f0f2f5;">

    <padding>
        <Insets top="10" right="10" bottom="10" left="10"/>
    </padding>

    <!-- Header -->
    <HBox alignment="CENTER_LEFT" spacing="15">
        <Label text="Gestion des Utilisateurs" styleClass="title-label"/>
        <Region HBox.hgrow="ALWAYS"/>
        <Label fx:id="countLabel" text="0 utilisateur(s)" styleClass="subtitle-label"/>
    </HBox>

    <!-- Form Card -->
    <VBox styleClass="card-small" spacing="16">
        <Label text="Informations de l'utilisateur" styleClass="section-title"/>
        <Separator/>

        <GridPane hgap="15" vgap="14" alignment="CENTER">
            <columnConstraints>
                <ColumnConstraints hgrow="ALWAYS" percentWidth="50"/>
                <ColumnConstraints hgrow="ALWAYS" percentWidth="50"/>
            </columnConstraints>
            <children>
                <!-- Row 0: Nom / PrÃ©nom -->
                <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="0">
                    <Label text="Nom" style="-fx-text-fill: #636e72; -fx-font-size: 12px; -fx-font-weight: bold;"/>
                    <TextField fx:id="nomField" promptText="Nom de famille" styleClass="text-field"/>
                </VBox>
                <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="0">
                    <Label text="PrÃ©nom" style="-fx-text-fill: #636e72; -fx-font-size: 12px; -fx-font-weight: bold;"/>
                    <TextField fx:id="prenomField" promptText="PrÃ©nom" styleClass="text-field"/>
                </VBox>

                <!-- Row 1: Email / TÃ©lÃ©phone -->
                <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="1">
                    <Label text="Email" style="-fx-text-fill: #636e72; -fx-font-size: 12px; -fx-font-weight: bold;"/>
                    <TextField fx:id="emailField" promptText="exemple@email.com" styleClass="text-field"/>
                </VBox>
                <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="1">
                    <Label text="TÃ©lÃ©phone" style="-fx-text-fill: #636e72; -fx-font-size: 12px; -fx-font-weight: bold;"/>
                    <TextField fx:id="telField" promptText="8 chiffres" styleClass="text-field"/>
                </VBox>

                <!-- Row 2: Password / Role -->
                <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="2">
                    <Label text="Mot de passe" style="-fx-text-fill: #636e72; -fx-font-size: 12px; -fx-font-weight: bold;"/>
                    <HBox spacing="0" alignment="CENTER_LEFT">
                        <StackPane HBox.hgrow="ALWAYS">
                            <PasswordField fx:id="passwordField" promptText="Mot de passe" styleClass="password-field"/>
                            <TextField fx:id="passwordVisible" promptText="Mot de passe" styleClass="text-field" visible="false"/>
                        </StackPane>
                        <Button fx:id="togglePasswordBtn" text="ðŸ‘" onAction="#togglePassword" styleClass="btn-toggle-password"/>
                    </HBox>
                </VBox>
                <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="2">
                    <Label text="RÃ´le" style="-fx-text-fill: #636e72; -fx-font-size: 12px; -fx-font-weight: bold;"/>
                    <ComboBox fx:id="roleCombo" promptText="Choisir un rÃ´le" maxWidth="Infinity" styleClass="combo-box"/>
                </VBox>
            </children>
        </GridPane>

        <!-- Status + Actions -->
        <Label fx:id="statusLabel" wrapText="true" textAlignment="CENTER" styleClass="error-label"/>

        <HBox spacing="12" alignment="CENTER">
            <Button text="âž•  Ajouter" onAction="#handleInsert" styleClass="btn-success"/>
            <Button text="âœï¸  Modifier" onAction="#handleUpdate" styleClass="btn-warning"/>
            <Button text="ðŸ—‘ï¸  Supprimer" onAction="#handleDelete" styleClass="btn-danger"/>
            <Button text="ðŸ§¹  Effacer" onAction="#clearFields" styleClass="btn-secondary"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Button text="ðŸ“„  Exporter PDF" onAction="#handleExportPdf" styleClass="btn-primary"/>
        </HBox>
    </VBox>

    <!-- Search Bar -->
    <HBox spacing="12" alignment="CENTER_LEFT">
        <TextField fx:id="searchField" promptText="ðŸ” Rechercher par nom, prÃ©nom ou email..."
                   HBox.hgrow="ALWAYS" styleClass="text-field"/>
    </HBox>

    <!-- Table -->
    <TableView fx:id="userTable" VBox.vgrow="ALWAYS" styleClass="table-view">
        <columns>
            <TableColumn fx:id="colNom" text="Nom" prefWidth="130"/>
            <TableColumn fx:id="colPrenom" text="PrÃ©nom" prefWidth="130"/>
            <TableColumn fx:id="colEmail" text="Email" prefWidth="230"/>
            <TableColumn fx:id="colRole" text="RÃ´le" prefWidth="110"/>
            <TableColumn fx:id="colTel" text="TÃ©lÃ©phone" prefWidth="130"/>
        </columns>
        <placeholder>
            <Label text="Aucun utilisateur trouvÃ©" styleClass="subtitle-label"/>
        </placeholder>
    </TableView>
</VBox>